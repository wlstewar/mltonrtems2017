/* MLton g9e30096-dirty (built Sun Oct 22 00:19:29 EDT 2017 on oem-virtual-machine) */
/*   created this file on Sun Oct 22 14:14:01 2017. */
/* Do not edit this file. */
/* Flag settings:  */
/*    align: 4 */
/*    atMLtons: (@MLton, --) */
/*    chunk: coalesce 4096 */
/*    closureConvertGlobalize: true */
/*    closureConvertShrink: true */
/*    codegen: i386-rtems4.11 */
/*    contifyIntoMain: false */
/*    debug: false */
/*    defaultChar: char8 */
/*    defaultWideChar: widechar32 */
/*    defaultInt: int32 */
/*    defaultReal: real64 */
/*    defaultWord: word32 */
/*    diag passes: [] */
/*    drop passes: [] */
/*    elaborate allowConstant (default): false */
/*    elaborate allowConstant (enabled): true */
/*    elaborate allowFFI (default): false */
/*    elaborate allowFFI (enabled): true */
/*    elaborate allowPrim (default): false */
/*    elaborate allowPrim (enabled): true */
/*    elaborate allowOverload (default): false */
/*    elaborate allowOverload (enabled): true */
/*    elaborate allowOptBar (default): false */
/*    elaborate allowOptBar (enabled): true */
/*    elaborate allowOptSemicolon (default): false */
/*    elaborate allowOptSemicolon (enabled): true */
/*    elaborate allowLineComments (default): false */
/*    elaborate allowLineComments (enabled): true */
/*    elaborate allowDoDecls (default): false */
/*    elaborate allowDoDecls (enabled): true */
/*    elaborate allowRecPunning (default): false */
/*    elaborate allowRecPunning (enabled): true */
/*    elaborate allowOrPats (default): false */
/*    elaborate allowOrPats (enabled): true */
/*    elaborate allowExtendedLiterals (default): false */
/*    elaborate allowExtendedLiterals (enabled): true */
/*    elaborate allowSigWithtype (default): false */
/*    elaborate allowSigWithtype (enabled): true */
/*    elaborate allowRebindEquals (default): false */
/*    elaborate allowRebindEquals (enabled): true */
/*    elaborate deadCode (default): false */
/*    elaborate deadCode (enabled): true */
/*    elaborate forceUsed (default): false */
/*    elaborate forceUsed (enabled): true */
/*    elaborate ffiStr (default):  */
/*    elaborate ffiStr (enabled): true */
/*    elaborate nonexhaustiveExnMatch (default): default */
/*    elaborate nonexhaustiveExnMatch (enabled): true */
/*    elaborate nonexhaustiveMatch (default): warn */
/*    elaborate nonexhaustiveMatch (enabled): true */
/*    elaborate redundantMatch (default): warn */
/*    elaborate redundantMatch (enabled): true */
/*    elaborate resolveScope (default): strdec */
/*    elaborate resolveScope (enabled): true */
/*    elaborate sequenceNonUnit (default): ignore */
/*    elaborate sequenceNonUnit (enabled): true */
/*    elaborate valrecConstr (default): warn */
/*    elaborate valrecConstr (enabled): true */
/*    elaborate warnUnused (default): false */
/*    elaborate warnUnused (enabled): true */
/*    elaborate only: false */
/*    emit main: true */
/*    export header: None */
/*    exn history: false */
/*    generated output format: executable */
/*    gc check: Limit */
/*    indentation: 3 */
/*    inlineIntoMain: true */
/*    inlineLeafA: {loops = true, repeat = true, size = Some 20} */
/*    inlineLeafB: {loops = true, repeat = true, size = Some 40} */
/*    inlineNonRec: {small = 60, product = 320} */
/*    input file: hello */
/*    keep AST: false */
/*    keep CoreML: false */
/*    keep def use: true */
/*    keep dot: false */
/*    keep Machine: false */
/*    keep passes: [] */
/*    keep RSSA: false */
/*    keep SSA: false */
/*    keep SSA2: false */
/*    keep SXML: false */
/*    keep XML: false */
/*    extra_: false */
/*    lib dir: /home/oem/pickle/take2/X86/build/lib */
/*    lib target dir: /home/oem/pickle/take2/X86/build/lib/targets/i386-rtems4.11 */
/*    loop passes: 1 */
/*    mark cards: true */
/*    max function size: 10000 */
/*    mlb path vars: [{var = MLTON_ROOT, path = $(LIB_MLTON_DIR)/sml}, {var = SML_LIB, path = $(LIB_MLTON_DIR)/sml}] */
/*    native commented: 0 */
/*    native live stack: false */
/*    native optimize: 1 */
/*    native move hoist: true */
/*    native copy prop: true */
/*    native copy prop cutoff: 1000 */
/*    native cutoff: 100 */
/*    native live transfer: 8 */
/*    native shuffle: true */
/*    native ieee fp: false */
/*    native split: Some 20000 */
/*    optimizationPasses: [<ssa2::default>, <ssa::default>, <sxml::default>, <xml::default>] */
/*    polyvariance: Some {hofo = true, rounds = 2, small = 30, product = 300} */
/*    prefer abs paths: false */
/*    prof passes: [] */
/*    profile: None */
/*    profile branch: false */
/*    profile C: [] */
/*    profile IL: ProfileSource */
/*    profile include/exclude: [(Seq [Star [.], Or [Seq [Seq [[$], [(], [S], [M], [L], [_], [L], [I], [B], [)]]]], Star [.]], false)] */
/*    profile raise: false */
/*    profile stack: false */
/*    profile val: false */
/*    show basis: None */
/*    show def-use: None */
/*    show types: true */
/*    target: i386-rtems4.11 */
/*    target arch: X86 */
/*    target OS: Rtems */
/*    type check: false */
/*    verbosity: Silent */
/*    warn unrecognized annotation: true */
/*    warn deprecated features: true */
/*    zone cut depth: 100 */
#define _ISOC99_SOURCE
#include <c-main.h>

PRIVATE struct GC_state gcState;
PRIVATE CPointer globalCPointer [0];
PRIVATE CPointer CReturnQ;
PRIVATE Int8 globalInt8 [0];
PRIVATE Int8 CReturnI8;
PRIVATE Int16 globalInt16 [0];
PRIVATE Int16 CReturnI16;
PRIVATE Int32 globalInt32 [0];
PRIVATE Int32 CReturnI32;
PRIVATE Int64 globalInt64 [0];
PRIVATE Int64 CReturnI64;
PRIVATE Objptr globalObjptr [304];
PRIVATE Objptr CReturnP;
PRIVATE Real32 globalReal32 [0];
PRIVATE Real32 CReturnR32;
PRIVATE Real64 globalReal64 [0];
PRIVATE Real64 CReturnR64;
PRIVATE Word8 globalWord8 [0];
PRIVATE Word8 CReturnW8;
PRIVATE Word16 globalWord16 [0];
PRIVATE Word16 CReturnW16;
PRIVATE Word32 globalWord32 [3];
PRIVATE Word32 CReturnW32;
PRIVATE Word64 globalWord64 [0];
PRIVATE Word64 CReturnW64;
PRIVATE Pointer globalObjptrNonRoot [1];
PRIVATE Pointer MLton_FFI_opArgsResPtr;
static int saveGlobals (FILE *f) {
	SaveArray (globalCPointer, f);
	SaveArray (globalInt8, f);
	SaveArray (globalInt16, f);
	SaveArray (globalInt32, f);
	SaveArray (globalInt64, f);
	SaveArray (globalObjptr, f);
	SaveArray (globalReal32, f);
	SaveArray (globalReal64, f);
	SaveArray (globalWord8, f);
	SaveArray (globalWord16, f);
	SaveArray (globalWord32, f);
	SaveArray (globalWord64, f);
	return 0;
}
static int loadGlobals (FILE *f) {
	LoadArray (globalCPointer, f);
	LoadArray (globalInt8, f);
	LoadArray (globalInt16, f);
	LoadArray (globalInt32, f);
	LoadArray (globalInt64, f);
	LoadArray (globalObjptr, f);
	LoadArray (globalReal32, f);
	LoadArray (globalReal64, f);
	LoadArray (globalWord8, f);
	LoadArray (globalWord16, f);
	LoadArray (globalWord32, f);
	LoadArray (globalWord64, f);
	return 0;
}
BeginVectorInits
VectorInitElem (1, 187, 11, (pointer)"afnosupport")
VectorInitElem (1, 236, 5, (pointer)"nostr")
VectorInitElem (1, 186, 12, (pointer)"addrnotavail")
VectorInitElem (1, 207, 5, (pointer)"ilseq")
VectorInitElem (1, 230, 6, (pointer)"nolink")
VectorInitElem (1, 298, 2, (pointer)" [")
VectorInitElem (1, 191, 6, (pointer)"badmsg")
VectorInitElem (1, 289, 35, (pointer)"Top-level suffix raised exception.\n")
VectorInitElem (1, 249, 5, (pointer)"proto")
VectorInitElem (1, 303, 8, (pointer)"flushOut")
VectorInitElem (1, 265, 16, (pointer)"Thread.atomicEnd")
VectorInitElem (1, 295, 4, (pointer)"Io: ")
VectorInitElem (1, 218, 8, (pointer)"multihop")
VectorInitElem (1, 301, 16, (pointer)"MLton.Exit.exit(")
VectorInitElem (1, 288, 5, (pointer)"done!")
VectorInitElem (1, 276, 4, (pointer)"Fail")
VectorInitElem (1, 216, 5, (pointer)"mlink")
VectorInitElem (1, 184, 5, (pointer)"acces")
VectorInitElem (1, 233, 10, (pointer)"noprotoopt")
VectorInitElem (1, 205, 11, (pointer)"hostunreach")
VectorInitElem (1, 204, 4, (pointer)"fbig")
VectorInitElem (1, 238, 7, (pointer)"notconn")
VectorInitElem (1, 196, 11, (pointer)"connrefused")
VectorInitElem (1, 267, 32, (pointer)"exit must have 0 <= status < 256")
VectorInitElem (1, 283, 8, (pointer)"<stdout>")
VectorInitElem (1, 217, 7, (pointer)"msgsize")
VectorInitElem (1, 271, 21, (pointer)"NullString.fromString")
VectorInitElem (1, 270, 1, (pointer)"\n")
VectorInitElem (1, 206, 4, (pointer)"idrm")
VectorInitElem (1, 188, 5, (pointer)"again")
VectorInitElem (1, 299, 8, (pointer)"SysErr: ")
VectorInitElem (1, 235, 4, (pointer)"nosr")
VectorInitElem (1, 296, 6, (pointer)"Fail: ")
VectorInitElem (1, 293, 14, (pointer)"\" failed with ")
VectorInitElem (1, 248, 4, (pointer)"pipe")
VectorInitElem (1, 292, 5, (pointer)"Fail8")
VectorInitElem (1, 272, 28, (pointer)"control shouldn\'t reach here")
VectorInitElem (1, 277, 6, (pointer)"SysErr")
VectorInitElem (1, 280, 4, (pointer)"Size")
VectorInitElem (1, 198, 6, (pointer)"deadlk")
VectorInitElem (1, 209, 4, (pointer)"intr")
VectorInitElem (1, 243, 5, (pointer)"notty")
VectorInitElem (1, 212, 6, (pointer)"isconn")
VectorInitElem (1, 194, 5, (pointer)"child")
VectorInitElem (1, 252, 5, (pointer)"range")
VectorInitElem (1, 240, 8, (pointer)"notempty")
VectorInitElem (1, 234, 5, (pointer)"nospc")
VectorInitElem (1, 214, 4, (pointer)"loop")
VectorInitElem (1, 223, 5, (pointer)"nfile")
VectorInitElem (1, 263, 1, (pointer)"]")
VectorInitElem (1, 219, 11, (pointer)"nametoolong")
VectorInitElem (1, 201, 5, (pointer)"dquot")
VectorInitElem (1, 286, 36, (pointer)"Top-level handler raised exception.\n")
VectorInitElem (1, 185, 9, (pointer)"addrinuse")
VectorInitElem (1, 284, 16, (pointer)"input/input1.txt")
VectorInitElem (1, 189, 7, (pointer)"already")
VectorInitElem (1, 260, 6, (pointer)"txtbsy")
VectorInitElem (1, 261, 10, (pointer)"wouldblock")
VectorInitElem (1, 203, 5, (pointer)"fault")
VectorInitElem (1, 251, 9, (pointer)"prototype")
VectorInitElem (1, 302, 6, (pointer)"output")
VectorInitElem (1, 237, 5, (pointer)"nosys")
VectorInitElem (1, 244, 4, (pointer)"nxio")
VectorInitElem (1, 231, 5, (pointer)"nomem")
VectorInitElem (1, 193, 8, (pointer)"canceled")
VectorInitElem (1, 255, 4, (pointer)"srch")
VectorInitElem (1, 253, 4, (pointer)"rofs")
VectorInitElem (1, 229, 5, (pointer)"nolck")
VectorInitElem (1, 221, 8, (pointer)"netreset")
VectorInitElem (1, 208, 10, (pointer)"inprogress")
VectorInitElem (1, 202, 5, (pointer)"exist")
VectorInitElem (1, 290, 7, (pointer)"closeIn")
VectorInitElem (1, 287, 9, (pointer)"inputLine")
VectorInitElem (1, 232, 5, (pointer)"nomsg")
VectorInitElem (1, 294, 2, (pointer)" \"")
VectorInitElem (1, 300, 16, (pointer)"0123456789ABCDEF")
VectorInitElem (1, 282, 12, (pointer)"ClosedStream")
VectorInitElem (1, 269, 21, (pointer)"MLton.Exit.wrapSuffix")
VectorInitElem (1, 285, 6, (pointer)"openIn")
VectorInitElem (1, 226, 5, (pointer)"nodev")
VectorInitElem (1, 242, 6, (pointer)"notsup")
VectorInitElem (1, 197, 9, (pointer)"connreset")
VectorInitElem (1, 195, 11, (pointer)"connaborted")
VectorInitElem (1, 246, 8, (pointer)"overflow")
VectorInitElem (1, 215, 5, (pointer)"mfile")
VectorInitElem (1, 227, 5, (pointer)"noent")
VectorInitElem (1, 250, 14, (pointer)"protonosupport")
VectorInitElem (1, 199, 11, (pointer)"destaddrreq")
VectorInitElem (1, 275, 36, (pointer)"unhandled exception in Basis Library")
VectorInitElem (1, 291, 13, (pointer)"Unknown error")
VectorInitElem (1, 258, 8, (pointer)"timedout")
VectorInitElem (1, 210, 5, (pointer)"inval")
VectorInitElem (1, 192, 4, (pointer)"busy")
VectorInitElem (1, 264, 21, (pointer)"Sequence.Slice.concat")
VectorInitElem (1, 220, 7, (pointer)"netdown")
VectorInitElem (1, 274, 5, (pointer)"Fail ")
VectorInitElem (1, 190, 4, (pointer)"badf")
VectorInitElem (1, 279, 8, (pointer)"Overflow")
VectorInitElem (1, 211, 2, (pointer)"io")
VectorInitElem (1, 247, 4, (pointer)"perm")
VectorInitElem (1, 256, 5, (pointer)"stale")
VectorInitElem (1, 266, 13, (pointer)"partial write")
VectorInitElem (1, 254, 5, (pointer)"spipe")
VectorInitElem (1, 262, 4, (pointer)"xdev")
VectorInitElem (1, 200, 3, (pointer)"dom")
VectorInitElem (1, 224, 6, (pointer)"nobufs")
VectorInitElem (1, 278, 2, (pointer)"Io")
VectorInitElem (1, 281, 9, (pointer)"Subscript")
VectorInitElem (1, 225, 6, (pointer)"nodata")
VectorInitElem (1, 297, 9, (pointer)"<UNKNOWN>")
VectorInitElem (1, 228, 6, (pointer)"noexec")
VectorInitElem (1, 273, 21, (pointer)"unhandled exception: ")
VectorInitElem (1, 239, 6, (pointer)"notdir")
VectorInitElem (1, 222, 10, (pointer)"netunreach")
VectorInitElem (1, 268, 3, (pointer)"): ")
VectorInitElem (1, 259, 6, (pointer)"toobig")
VectorInitElem (1, 257, 4, (pointer)"time")
VectorInitElem (1, 245, 9, (pointer)"opnotsupp")
VectorInitElem (1, 241, 7, (pointer)"notsock")
VectorInitElem (1, 213, 5, (pointer)"isdir")
EndVectorInits
static void real_Init() {
}
static uint16_t frameOffsets0[] = {0};
static uint16_t frameOffsets1[] = {2,8,12};
static uint16_t frameOffsets2[] = {3,8,12,20};
static uint16_t frameOffsets3[] = {5,8,12,16,20,24};
static uint16_t frameOffsets4[] = {7,8,12,16,20,24,28,36};
static uint16_t frameOffsets5[] = {7,12,16,20,24,28,40,44};
static uint16_t frameOffsets6[] = {6,8,12,16,28,32,36};
static uint16_t frameOffsets7[] = {1,8};
static uint16_t frameOffsets8[] = {5,8,12,28,32,36};
static uint16_t frameOffsets9[] = {6,8,12,20,28,32,36};
static uint16_t frameOffsets10[] = {9,8,12,20,24,28,32,36,40,44};
static uint16_t frameOffsets11[] = {8,8,12,20,24,28,32,36,48};
static uint16_t frameOffsets12[] = {10,8,12,20,24,28,32,36,40,44,48};
static uint16_t frameOffsets13[] = {11,8,12,20,24,28,32,36,40,44,48,64};
static uint16_t frameOffsets14[] = {2,12,36};
static uint16_t frameOffsets15[] = {3,8,12,36};
static uint16_t frameOffsets16[] = {12,8,12,20,24,28,32,36,40,44,48,52,56};
static uint16_t frameOffsets17[] = {5,12,20,32,36,44};
static uint16_t frameOffsets18[] = {9,8,12,20,24,28,32,36,40,48};
static uint16_t frameOffsets19[] = {3,12,24,36};
static uint16_t frameOffsets20[] = {7,8,12,20,24,28,32,36};
static uint16_t frameOffsets21[] = {6,8,12,24,28,32,36};
static uint16_t frameOffsets22[] = {6,8,12,16,20,24,28};
static uint16_t frameOffsets23[] = {8,8,12,16,20,24,28,40,44};
static uint16_t frameOffsets24[] = {9,8,12,16,20,24,28,32,40,44};
static uint16_t frameOffsets25[] = {1,20};
static uint16_t frameOffsets26[] = {8,8,12,16,20,24,28,36,40};
static uint16_t frameOffsets27[] = {4,8,12,16,20};
static uint16_t frameOffsets28[] = {3,8,12,16};
static uint16_t frameOffsets29[] = {2,4,12};
static uint16_t frameOffsets30[] = {1,12};
static uint16_t frameOffsets31[] = {1,4};
static uint16_t frameOffsets32[] = {2,4,16};
static uint16_t frameOffsets33[] = {3,4,16,20};
static uint16_t frameOffsets34[] = {1,0};
static uint16_t frameOffsets35[] = {2,0,4};
static uint16_t frameOffsets36[] = {2,4,8};
static uint16_t frameOffsets37[] = {3,0,4,8};
static uint16_t frameOffsets38[] = {2,16,24};
static uint16_t frameOffsets39[] = {2,16,36};
static uint16_t frameOffsets40[] = {1,16};
static uint16_t frameOffsets41[] = {3,4,16,24};
static uint16_t frameOffsets42[] = {3,8,20,28};
static uint16_t frameOffsets43[] = {4,0,4,16,20};
static uint16_t frameOffsets44[] = {5,0,4,16,28,32};
static uint16_t frameOffsets45[] = {2,16,20};
static uint16_t frameOffsets46[] = {2,4,24};
static uint16_t frameOffsets47[] = {5,0,4,16,24,28};
static struct GC_frameLayout frameLayouts[] = {
	{C_FRAME, frameOffsets0, 4},
	{ML_FRAME, frameOffsets0, 4},
	{C_FRAME, frameOffsets1, 20},
	{C_FRAME, frameOffsets2, 28},
	{C_FRAME, frameOffsets3, 32},
	{ML_FRAME, frameOffsets4, 44},
	{C_FRAME, frameOffsets5, 52},
	{C_FRAME, frameOffsets6, 44},
	{ML_FRAME, frameOffsets7, 16},
	{ML_FRAME, frameOffsets0, 12},
	{ML_FRAME, frameOffsets8, 44},
	{ML_FRAME, frameOffsets9, 44},
	{ML_FRAME, frameOffsets10, 52},
	{C_FRAME, frameOffsets11, 56},
	{ML_FRAME, frameOffsets12, 56},
	{C_FRAME, frameOffsets12, 68},
	{C_FRAME, frameOffsets13, 72},
	{C_FRAME, frameOffsets12, 64},
	{C_FRAME, frameOffsets14, 44},
	{C_FRAME, frameOffsets12, 72},
	{C_FRAME, frameOffsets15, 44},
	{C_FRAME, frameOffsets16, 64},
	{ML_FRAME, frameOffsets17, 52},
	{ML_FRAME, frameOffsets14, 44},
	{C_FRAME, frameOffsets17, 52},
	{C_FRAME, frameOffsets12, 60},
	{C_FRAME, frameOffsets12, 56},
	{C_FRAME, frameOffsets18, 56},
	{C_FRAME, frameOffsets10, 52},
	{C_FRAME, frameOffsets19, 44},
	{C_FRAME, frameOffsets20, 44},
	{C_FRAME, frameOffsets9, 44},
	{C_FRAME, frameOffsets8, 44},
	{C_FRAME, frameOffsets21, 44},
	{C_FRAME, frameOffsets22, 36},
	{C_FRAME, frameOffsets23, 52},
	{C_FRAME, frameOffsets24, 52},
	{C_FRAME, frameOffsets0, 24},
	{C_FRAME, frameOffsets25, 28},
	{C_FRAME, frameOffsets0, 16},
	{C_FRAME, frameOffsets26, 48},
	{C_FRAME, frameOffsets4, 48},
	{C_FRAME, frameOffsets27, 28},
	{C_FRAME, frameOffsets28, 24},
	{C_FRAME, frameOffsets7, 16},
	{C_FRAME, frameOffsets1, 24},
	{C_FRAME, frameOffsets1, 28},
	{C_FRAME, frameOffsets0, 12},
	{C_FRAME, frameOffsets29, 20},
	{C_FRAME, frameOffsets29, 28},
	{C_FRAME, frameOffsets30, 20},
	{C_FRAME, frameOffsets0, 8},
	{C_FRAME, frameOffsets31, 12},
	{ML_FRAME, frameOffsets32, 24},
	{ML_FRAME, frameOffsets0, 20},
	{C_FRAME, frameOffsets33, 28},
	{C_FRAME, frameOffsets34, 20},
	{ML_FRAME, frameOffsets31, 20},
	{C_FRAME, frameOffsets32, 24},
	{C_FRAME, frameOffsets31, 20},
	{C_FRAME, frameOffsets35, 20},
	{C_FRAME, frameOffsets36, 20},
	{C_FRAME, frameOffsets7, 20},
	{C_FRAME, frameOffsets37, 16},
	{C_FRAME, frameOffsets34, 8},
	{C_FRAME, frameOffsets38, 40},
	{C_FRAME, frameOffsets39, 44},
	{C_FRAME, frameOffsets40, 28},
	{C_FRAME, frameOffsets41, 32},
	{C_FRAME, frameOffsets34, 12},
	{ML_FRAME, frameOffsets42, 36},
	{C_FRAME, frameOffsets42, 40},
	{C_FRAME, frameOffsets35, 12},
	{ML_FRAME, frameOffsets43, 28},
	{ML_FRAME, frameOffsets44, 40},
	{C_FRAME, frameOffsets44, 44},
	{C_FRAME, frameOffsets45, 28},
	{ML_FRAME, frameOffsets40, 24},
	{C_FRAME, frameOffsets43, 28},
	{C_FRAME, frameOffsets31, 32},
	{C_FRAME, frameOffsets46, 48},
	{C_FRAME, frameOffsets47, 56},
};
static struct GC_objectType objectTypes[] = {
	{ STACK_TAG, FALSE, 0, 0 },
	{ NORMAL_TAG, TRUE, 8, 1 },
	{ WEAK_TAG, FALSE, 8, 0 },
	{ ARRAY_TAG, FALSE, 1, 0 },
	{ ARRAY_TAG, FALSE, 4, 0 },
	{ ARRAY_TAG, FALSE, 2, 0 },
	{ ARRAY_TAG, FALSE, 8, 0 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, TRUE, 4, 0 },
	{ NORMAL_TAG, TRUE, 8, 0 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ ARRAY_TAG, TRUE, 1, 0 },
	{ NORMAL_TAG, FALSE, 8, 0 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ NORMAL_TAG, FALSE, 0, 3 },
	{ NORMAL_TAG, TRUE, 4, 0 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, FALSE, 0, 6 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 3 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, TRUE, 4, 0 },
	{ NORMAL_TAG, FALSE, 0, 4 },
	{ NORMAL_TAG, FALSE, 12, 0 },
	{ ARRAY_TAG, TRUE, 4, 0 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, TRUE, 0, 1 },
	{ NORMAL_TAG, FALSE, 0, 3 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 1 },
	{ NORMAL_TAG, FALSE, 0, 1 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ NORMAL_TAG, FALSE, 0, 3 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 4, 0 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 12, 1 },
	{ NORMAL_TAG, FALSE, 4, 1 },
	{ NORMAL_TAG, FALSE, 8, 1 },
	{ NORMAL_TAG, FALSE, 4, 0 },
	{ NORMAL_TAG, FALSE, 8, 1 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 2 },
	{ NORMAL_TAG, FALSE, 0, 1 },
	{ NORMAL_TAG, FALSE, 0, 1 },
};
static uint32_t* sourceSeqs[] = {
};
static GC_sourceSeqIndex frameSources[] = {
};
static struct GC_sourceLabel sourceLabels[] = {
};
static char* sourceNames[] = {
};
static struct GC_source sources[] = {
};
static char* atMLtons[] = {
	"@MLton",
	"--",
};
DeclareChunk (0);
PRIVATE struct cont ( *nextChunks []) () = {	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
	Chunkp (0),
};
MLtonMain (4, 0xC2462CE9, 72, TRUE, PROFILE_NONE, FALSE, 0, 156)

#include <errno.h>
#include <rtems/ramdisk.h>
#include <rtems/error.h>
#include <rtems/untar.h>
#include <rtems/shell.h>

#include "FilesystemImage.h"


#define CONFIGURE_MAXIMUM_POSIX_KEYS             16
#define CONFIGURE_MAXIMUM_POSIX_KEY_VALUE_PAIRS  16

#define CONFIGURE_SHELL_COMMANDS_INIT
#define CONFIGURE_SHELL_COMMANDS_ALL
#define CONFIGURE_SHELL_MOUNT_MSDOS

#include <rtems/shellconfig.h>

/* drivers */
#define CONFIGURE_APPLICATION_NEEDS_CLOCK_DRIVER
#define CONFIGURE_APPLICATION_NEEDS_CONSOLE_DRIVER

/* filesystem */
#define CONFIGURE_USE_IMFS_AS_BASE_FILESYSTEM
#define CONFIGURE_LIBIO_MAXIMUM_FILE_DESCRIPTORS   40
#define CONFIGURE_IMFS_MEMFILE_BYTES_PER_BLOCK    512
#define CONFIGURE_MAXIMUM_DRIVERS                  10

#define CONFIGURE_APPLICATION_NEEDS_LIBBLOCK
#define CONFIGURE_SWAPOUT_TASK_PRIORITY            10

#define CONFIGURE_MAXIMUM_TASKS                    rtems_resource_unlimited (10)
#define CONFIGURE_MAXIMUM_SEMAPHORES               rtems_resource_unlimited (10)
#define CONFIGURE_MAXIMUM_MESSAGE_QUEUES           rtems_resource_unlimited (5)
#define CONFIGURE_MAXIMUM_PARTITIONS               rtems_resource_unlimited (2)
#define CONFIGURE_UNIFIED_WORK_AREAS
#define CONFIGURE_RTEMS_INIT_TASKS_TABLE

#define CONFIGURE_INIT
#include <rtems/confdefs.h>

rtems_ramdisk_config rtems_ramdisk_configuration[] =
{
  {
    block_size: 256,
    block_num:  1024,
    location:   NULL
  }
};

/**
 * The number of RAM Disk configurations.
 */
size_t rtems_ramdisk_configuration_size = 1;

/**
 * Create the RAM Disk Driver entry.
 */
rtems_driver_address_table rtems_ramdisk_io_ops = {
  initialization_entry: ramdisk_initialize,
  open_entry:           rtems_blkdev_generic_open,
  close_entry:          rtems_blkdev_generic_close,
  read_entry:           rtems_blkdev_generic_read,
  write_entry:          rtems_blkdev_generic_write,
  control_entry:        rtems_blkdev_generic_ioctl
};

#define RTEMS_DRIVER_AUTO_MAJOR (0)

int setup_ramdisk (const char* mntpath)
{
  rtems_device_major_number major;
  rtems_status_code         sc;

  /*
   * Register the RAM Disk driver.
   */
  printf ("Register RAM Disk Driver: ");
  sc = rtems_io_register_driver (RTEMS_DRIVER_AUTO_MAJOR,
                                 &rtems_ramdisk_io_ops,
                                 &major);
  if (sc != RTEMS_SUCCESSFUL) {
    printf ("error: ramdisk driver not initialised: %s\n",
            rtems_status_text (sc));
    return 1;
  }

  printf ("successful\n");
  return 0;
}

/**
 * Run the /shell-init script.
 */
void shell_init_script(void)
{
  rtems_status_code sc;
  printf("Running /shell-init....\n\n");
  sc = rtems_shell_script("fstst", 60 * 1024, 160, "/shell-init", "stdout",
                           0, 1, 1);
  if (sc != RTEMS_SUCCESSFUL)
    printf("error: running shell script: %s (%d)\n",
             rtems_status_text (sc), sc);
}

/**
 * Start the RTEMS Shell.
 */
void shell_start ()
{
  rtems_status_code sc;
  printf ("Starting shell....\n\n");
  sc = rtems_shell_init ("fstst", 60 * 1024, 150, "/dev/console", 0, 1, NULL);
  if (sc != RTEMS_SUCCESSFUL)
    printf ("error: starting shell: %s (%d)\n", rtems_status_text (sc), sc);
}



rtems_task Init(
  rtems_task_argument ignored
)
{
  int ret;

  puts( "\n\n*** ramdisk/fat example ***" );

  printf("Unpacking tar filesystem\nThis may take awhile...\n");
  if(Untar_FromMemory((char*) FilesystemImage, FilesystemImage_size) != 0) {
    printf("Can't unpack tar filesystem\n");
    exit(1);
  }

  ret = setup_ramdisk ("/mnt/ramdisk");
  if (ret)
    exit (ret);

  shell_init_script();
  shell_start();
  
  printf("HELLO!!!\n");
  char* a[0]; //MLton has to be fed some dummy argc and argv arguments
  (MLton_main (0, a));
  exit(0); //Might be unnecessary shrugascii
  
  printf( "*** end of demonstration ***\n" );
  exit( 0 );
}
